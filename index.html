<!DOCTYPE html>
<html>
    <head lang="en">
		<link rel="stylesheet" type="text/css" href="./styles.css"/>
        <meta charset="utf-8"/>
        <title>How many times have I unlocked my phone today?</title>
        <script>
            function refresh(cnt) {
				fetch('https://howmanytimeshaveiunlockedmyphonetoday.rasimas.lt/api') 
                    .then(response => response.json())
                    .then(txt => cnt.innerText = txt)
					.catch(() => {});
					setTimeout(() => refresh(cnt), 50);
            }
            document.addEventListener("DOMContentLoaded", function(event) {
                let counter = document.getElementById("counter")
                refresh(counter)
				fetch('https://howmanytimeshaveiunlockedmyphonetoday.rasimas.lt/history.txt')
					.then(response => response.text())
					.then(resp => {
						let arr = resp.split('\n');
						arr.pop();
						arr.forEach((el) => {
							let tag = document.createElement('h4')
							tag.innerText = el
							document.getElementById('history').appendChild(tag)
						});
					});
            })
        </script>
    </head>
    <body>
        <h1>How many times have I unlocked my phone today?</h1>
        <h2 id="counter"></h2>
		<h3>History</h3>
		<div id="history"</div>
		<a id="source" href="https://github.com/kibartas/PhoneUnlockListener"><h3>Source code</h3></a>
    </body>
</html>
